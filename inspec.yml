name: cms-ars-5.0-red-hat-enterprise-linux-8-stig-overlay
title: cms-ars-5.0-red-hat-enterprise-linux-8-stig-overlay
maintainer: CMS SAF team
copyright: .
copyright_email: saf@cms.hhs.gov
license: Apache-2.0
summary: "CMS ARS 5.0 Overlay InSpec Validation Profile for RHEL8 STIG"
version: 1.3.0
inspec_version: ">= 4.0"

depends:
- name: redhat-enterprise-linux-8-stig-baseline
  #url: https://github.com/ssayed118/redhat-enterprise-linux-8-stig-baseline.git
  url: https://github.com/ssayed118/redhat-enterprise-linux-8-stig-baseline/archive/main.tar.gz

inputs:
  - name: system_categorization
    desc: "Selected system baseline based on the environment variable"
    type: String
    value: <%= ENV['BASELINE'].nil? ? 'Moderate (Default)' : ENV['BASELINE'] %>

  - name: org_name
    desc: "Name of the organization running this profile"
    type: Hash
    value:
      acronym: "CMS"
      full_form: "Centers for Medicare & Medicaid Services"
    profile: redhat-enterprise-linux-8-stig-baseline

  - name: overlay_controls
    desc: 'List of inapplicable controls in ARS 5.0 based on the system categorization'
    type: Array
<% if ENV['BASELINE'] == 'High-HVA' %>
    value: [] 
<% elsif ENV['BASELINE'] == 'High' %>
    value: []
<% elsif ENV['BASELINE'] == 'Moderate-HVA' %>
    value: 
      - "SV-230346" # AC-10
      - "SV-230483" # AU-5 (1)
      - "SV-244543" # AU-5 (1)
      - "SV-230296" # IA-2 (5)
      - "SV-230282" # SI-6 a
<% elsif ENV['BASELINE'] == 'Moderate' || ENV['BASELINE'].nil? %> # Default
    value:
      - "SV-230240" # SC-3
      - "SV-230241" # SC-3
      - "SV-230277" # SC-3
      - "SV-230278" # SC-3
      - "SV-230279" # SC-3
      - "SV-230282" # SI-2 (6)
      - "SV-230296" # IA-2 (5)
      - "SV-230346" # AC-10
      - "SV-230475" # AU-9 (3)
      - "SV-230483" # AU-5 (1)
      - "SV-244543" # AU-5 (1)
<% elsif ENV['BASELINE'] == 'Low-HVA' %>
    value:
      - "SV-230346" # AC-10
      - "SV-230347" # AC-11
      - "SV-230348" # AC-11
      - "SV-230349" # AC-11
      - "SV-230350" # AC-11
      - "SV-230351" # AC-11
      - "SV-230352" # AC-11
      - "SV-230353" # AC-11
      - "SV-230354" # AC-11
      - "SV-230535" # AC-11
      - "SV-230537" # AC-11
      - "SV-230538" # AC-11
      - "SV-230539" # AC-11
      - "SV-230228" # AC-17 (1)
      - "SV-230504" # AC-17 (1)
      - "SV-230505" # AC-17 (1)
      - "SV-244544" # AC-17 (1)
      - "SV-230506" # AC-18 (1)
      - "SV-230507" # AC-18 (1)
      - "SV-230483" # AU-5 (1)
      - "SV-244543" # AU-5 (1)
      - "SV-230508" # CM-7 (2)
      - "SV-230509" # CM-7 (2)
      - "SV-230510" # CM-7 (2)
      - "SV-230511" # CM-7 (2)
      - "SV-230512" # CM-7 (2)
      - "SV-230513" # CM-7 (2)
      - "SV-230514" # CM-7 (2)
      - "SV-230515" # CM-7 (2)
      - "SV-230516" # CM-7 (2)
      - "SV-230517" # CM-7 (2)
      - "SV-230518" # CM-7 (2)
      - "SV-230519" # CM-7 (2)
      - "SV-230520" # CM-7 (2)
      - "SV-230521" # CM-7 (2)
      - "SV-230522" # CM-7 (2)
      - "SV-230523" # CM-7 (2)
      - "SV-230545" # CM-7 (2)
      - "SV-230546" # CM-7 (2)
      - "SV-230296" # IA-2 (5)
      - "SV-230229" # IA-5 (2)
      - "SV-230230" # IA-5 (2)
      - "SV-230355" # IA-5 (2)
      - "SV-230242" # SC-4
      - "SV-230243" # SC-4
      - "SV-230269" # SC-4
      - "SV-230270" # SC-4
      - "SV-230244" # SC-10
      - "SV-244525" # SC-10
      - "SV-244540" # SI-2 (2)
      - "SV-230282" # SI-6
      - "SV-230245" # SI-11
      - "SV-230246" # SI-11
      - "SV-230247" # SI-11
      - "SV-230248" # SI-11
      - "SV-230249" # SI-11
      - "SV-230250" # SI-11
      - "SV-230276" # SI-16
      - "SV-230280" # SI-16

<% elsif ENV['BASELINE'] == 'Low' %> 
    value:
      - "SV-230331" # AC-2 (2)
      - "SV-230374" # AC-2 (2)
      - "SV-237642" # AC-6 (5)
      - "SV-230346" # AC-10
      - "SV-230347" # AC-11
      - "SV-230348" # AC-11
      - "SV-230349" # AC-11
      - "SV-230350" # AC-11
      - "SV-230351" # AC-11
      - "SV-230352" # AC-11
      - "SV-230353" # AC-11
      - "SV-230354" # AC-11
      - "SV-230535" # AC-11
      - "SV-230537" # AC-11
      - "SV-230538" # AC-11
      - "SV-230539" # AC-11
      - "SV-230228" # AC-17 (1)
      - "SV-230504" # AC-17 (1)
      - "SV-230505" # AC-17 (1)
      - "SV-244544" # AC-17 (1)
      - "SV-230223" # AC-17 (2)
      - "SV-230251" # AC-17 (2)
      - "SV-230252" # AC-17 (2)
      - "SV-230254" # AC-17 (2)
      - "SV-230255" # AC-17 (2)
      - "SV-230256" # AC-17 (2)
      - "SV-230257" # AC-17 (2)
      - "SV-244526" # AC-17 (2)
      - "SV-230506" # AC-18 (1)
      - "SV-230507" # AC-18 (1)
      - "SV-230483" # AU-5 (1)
      - "SV-244543" # AU-5 (1)
      - "SV-230475" # AU-9 (3)
      - "SV-230508" # CM-7 (2)
      - "SV-230509" # CM-7 (2)
      - "SV-230510" # CM-7 (2)
      - "SV-230511" # CM-7 (2)
      - "SV-230512" # CM-7 (2)
      - "SV-230513" # CM-7 (2)
      - "SV-230514" # CM-7 (2)
      - "SV-230515" # CM-7 (2)
      - "SV-230516" # CM-7 (2)
      - "SV-230517" # CM-7 (2)
      - "SV-230518" # CM-7 (2)
      - "SV-230519" # CM-7 (2)
      - "SV-230520" # CM-7 (2)
      - "SV-230521" # CM-7 (2)
      - "SV-230522" # CM-7 (2)
      - "SV-230523" # CM-7 (2)
      - "SV-230545" # CM-7 (2)
      - "SV-230546" # CM-7 (2)
      - "SV-230296" # IA-2 (5)
      - "SV-230502" # IA-3
      - "SV-230503" # IA-3
      - "SV-230524" # IA-3
      - "SV-244547" # IA-3
      - "SV-244548" # IA-3
      - "SV-230229" # IA-5 (2)
      - "SV-230230" # IA-5 (2)
      - "SV-230355" # IA-5 (2) 
      - "SV-230240" # SC-3
      - "SV-230241" # SC-3
      - "SV-230277" # SC-3
      - "SV-230278" # SC-3
      - "SV-230279" # SC-3
      - "SV-230242" # SC-4
      - "SV-230243" # SC-4
      - "SV-230269" # SC-4
      - "SV-230270" # SC-4
      - "SV-230526" # SC-8
      - "SV-244549" # SC-8
      - "SV-230244" # SC-10
      - "SV-244525" # SC-10      
      - "SV-230224" # SC-28
      - "SV-244540" # SI-2 (2)
      - "SV-230282" # SI-6
      - "SV-230245" # SI-11
      - "SV-230246" # SI-11
      - "SV-230247" # SI-11
      - "SV-230248" # SI-11
      - "SV-230249" # SI-11
      - "SV-230250" # SI-11
      - "SV-230276" # SI-16
      - "SV-230280" # SI-16
# <% else %>
#     required: true
<% end %>